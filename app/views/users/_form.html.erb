<div data-controller="">
  <%= simple_form_for user do |f| %>

    <div class="d-block">
      <% if user.errors.any? %>
        <div class="alert alert-danger" role="alert">
          <div style="color: red">
            <br>
            <h2 class="text-center"><%= pluralize(user.errors.count, "error")%> prohibited this user from being saved:</h2>
            <ul>
              <div class="mx-auto" style="width: 50%;">
                <% user.errors.each do |error| %>
                  <li><%= error.full_message %></li>
                <% end %>
              </div>
            </ul>
          </div>
        </div>
      <% end %>
    </div>

    <div class="row">
      <div class="col-md-3 text-center" data-controller="profile-pic-preview">
          <% if user.user_profile_pic.attached? %>
            <%= image_tag user.user_profile_pic, class: "preview-profile-pic profile-pic", data:{"profile-pic-preview-target": "existingMain"} %>
            <%= image_tag '', class:"preview-profile-pic profile-pic", style: "display: none;", data: { "profile-pic-preview-target": "previewMain" } %>
          <% else %>
            <%= image_tag "profile-pic.jpg", class: "preview-profile-pic profile-pic", data:{"profile-pic-preview-target": "existingMain"} %>
            <%= image_tag '', class: "preview-profile-pic profile-pic", style: "display: none;", data: { "profile-pic-preview-target": "previewMain" } %>
          <% end %>
          <i class="bi bi-pencil-square circle-icon cursor-pointer" data-bs-toggle="modal" data-bs-target="#profilePicModal" style="color: white;"></i>

        <br>
        <br>

        <!-- Button trigger modal -->

        <!-- Modal -->
        <div class="modal fade" id="profilePicModal" tabindex="-1" aria-labelledby="profilePicModalLabel" aria-hidden="true" >
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" >
              <div class="modal-header border border-0">
                <h1 class="modal-title fs-5 text-center font-color-custom-1" id="profilePicModalLabel">Edit User Profile Pic</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="border-bottom hr-show-custom mb-4" style="margin-left:4%;"></div>
              <div class="modal-body">
                <div class="d-flex justify-content-center align-items-center" style="heigt:30%;">

                <% if user.user_profile_pic.attached? %>
                  <%= image_tag user.user_profile_pic, class: "preview-profile-pic profile-pic", data: {"profile-pic-preview-target": "existing" } %>
                  <%= image_tag '', class:"preview-profile-pic",  style: "display: none;", data: { "profile-pic-preview-target": "preview" } %>
                <% else %>
                  <%= image_tag "profile-pic.jpg", class: "preview-profile-pic profile-pic", data: { "profile-pic-preview-target": "existing" } %>
                  <%= image_tag '', class:"preview-profile-pic",  style: "display: none;", data: { "profile-pic-preview-target": "preview" } %>
                <% end %>

                </div>
              </div>
                <br>
              <div class="border-bottom hr-show-custom mb-4" style="margin-left:4%;" ></div>
              <div class="modal-footer border border-0">
                  <%= f.label :user_profile_pic, "Upload Picture", class: "btn btn-primary btn-sm" %>
                  <%= f.file_field :user_profile_pic, class: "d-none", data:{action: "change->profile-pic-preview#preview"} %>
                  <% if user.user_profile_pic.attached? %>
                    <%= link_to "Delete Pic", delete_user_profile_pic_user_path(user), class: "btn btn-sm btn-danger", method: :delete, data: { "turbo-confirm": "Are you sure?" } %>
                  <% end %>
              </div>
            </div>
          </div>
        </div>


        <br>
        <!--<p class="text-center font-color-custom-1"><%= link_to 'Add position', '#', class: "btn btn-success", data: { action: 'click->players-form#addDropdown', 'players-form-target': 'dropdownButton' } %></p>-->
        
      </div>
      <div class="col-md-9">
        <div class="text-center">
          <h1 class="mt-4 font-color-custom-1">
            <%= f.text_field :username, class: "form-control user-show-names text-center", placeholder:"Username", style: "display: inline-block;" %>
          </h1>
          <h4 class="mt-1 font-color-custom-1">
            <%= f.text_field :email, class: "form-control user-show-names text-center", placeholder:"Email", style: "display: inline-block;" %>
          </h4>
        </div>
        <br>
        <br>

        <div class="border-bottom hr-show-custom mb-4" ></div>

        
        <div class="row">
          <div class="col-md-6 font-color-custom-1 d-flex align-items-center mb-4">
            <span aria-hidden="true" class="text-danger">*</span>&nbsp;Password:
          </div>
          <div class="col-md-5 font-color-custom-1 d-flex align-items-center mb-4">
            <%= f.password_field :password, class: "form-control user-form-field w-100", placeholder:"Password" %>
          </div>
        </div>

        <div class="border-bottom hr-show-custom mb-4" ></div>


        <div class="row">
          <div class="col-md-6 font-color-custom-1 d-flex mb-4">
            <span aria-hidden="true" class="text-danger">*</span>&nbsp;Confirm Password:
          </div>
          <div class="col-md-5 font-color-custom-1 d-flex align-items-center mb-4">
              <%= f.password_field :password_confirmation, class: "form-control user-form-field w-100", id: "floatingMedicalAid", placeholder:"Confirm Password"%>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 font-color-custom-1 d-flex mb-4">
            <span aria-hidden="true" class="text-danger">*</span>&nbsp;Role:
          </div>
          <div class="col-md-5 font-color-custom-1 d-flex align-items-center mb-4">
              <%= f.select :role, User.roles.keys.map { |role| [role.titleize, role] }, { include_blank: 'Select Role' }, class:"form-control" %>
          </div>
        </div>

        <br>
        <div class="border-bottom hr-show-custom mb-5" ></div>

        <div class="d-flex justify-content-center" style="gap: 200px;">
          <%# <%= link_to 'Delete user', player_path(@user), method: :delete, data: { confirm: 'Are you sure?' } class:"btn btn-danger primary-background" %>
          <div>
            <%= f.submit "Save", class: "btn btn-success mb-5" %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
